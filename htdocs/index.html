<!DOCTYPE HTML>
<html>
    <head>
        <title> Alice - DevKit </title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css">

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>
    <body>
        <!-- Alice Devkit CSS -->
        <style type="text/css">
            body {
                padding-top: 70px;
            }

            h2 {
                margin-top: 0;
            }

            .alice-view {
                display: none;
            }

            .nav-pills > li .close {
			    margin: 2px -2px 0 6px;
			    font-size: 17px;
			}

			.control-actions button {
			    margin-right: 20px;
			}

			.heroicons img {
			    margin-top: 4px;
			}

			.border {
			    border-left: 1px solid #eee;
			}
        </style>

        <!-- Top Navigation Bar -->
        <div class="navbar navbar-default navbar-fixed-top " role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#">Alice - DevKit</a>
                </div>
                <div id="nav-main">
                    <!-- Left Side -->
                    <ul class="nav navbar-nav">
                        <li>
                            <a id="main-about" href="#">About</a>
                        </li>
                        <li>
                            <a data-toggle="modal" data-target="#entityModal" id="main-entities" href="#">Entities</a>
                        </li>
                        <li>
                            <a data-toggle="modal" data-target="#stringtableModal" id="main-stringtables" href="#">Stringtables</a>
                        </li>
                        <li>
                            <a id="main-recvprops" href="#">Recvprops</a>
                        </li>
                        <li>
                            <a id="main-sendprops" href="#">Sendprops</a>
                        </li>
                    </ul>
                    <!-- Right Side -->
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a id="toggle-control" href="#">
                                <span class="glyphicon glyphicon-th"></span> Control
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/AliceStats">
                                <span class="glyphicon glyphicon-cloud-download"></span> Alice on Github
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Content -->
        <div class="container-fluid">
            <!-- Control current replay -->
            <div id="control" class="panel panel-default">
                <div class="panel-body">
                    <div class="row">
                        <!-- Open a Replay -->
                        <div class="col-lg-4">
                            <div class="input-group">
                                <div class="input-group-btn">
                                    <button type="button" class="btn btn-default" tabindex="-1">Open</button>
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" tabindex="-1">
                                        <span class="caret"></span>
                                        <span class="sr-only">Toggle Dropdown</span>
                                    </button>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="#">Replay 1</a></li>
                                        <li><a href="#">Replay 2</a></li>
                                        <li><a href="#">Replay 3</a></li>
                                    </ul>
                                </div>
                                <input class="form-control" type="text">
                            </div>
                        </div>
                        <!-- Parse X Messages -->
                        <div class="col-lg-2">
                            <div class="input-group">
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button">Parse</button>
                                </span>
                                <input type="text" class="form-control" placeholder="100">
                            </div>
                        </div>
                        <!-- Reload / Export / Close replay -->
                        <div class="control-actions col-lg-4">
                            <button class="btn btn-default" type="button">Reload</button>
                            <button class="btn btn-default" type="button">Export JSON</button>
                            <button class="btn btn-default" type="button">Close</button>
                        </div>
                    </div>
                    <hr />
                    <div class="row">
                        <!-- Current Message Count -->
                        <div class="col-lg-2">
                            <div class="input-group">
                                <span class="input-group-addon">Count</span>
                                <input type="text" class="form-control" placeholder="0">
                            </div>
                        </div>

                        <!-- Current Game Time -->
                        <div class="col-lg-2">
                            <div class="input-group">
                                <span class="input-group-addon">Time</span>
                                <input type="text" class="form-control" placeholder="00:00">
                            </div>
                        </div>

                        <!-- Score -->
                        <div class="col-lg-2">
                            <div class="input-group">
                                <span class="input-group-addon">Score</span>
                                <input type="text" class="form-control" placeholder="0 - 0">
                            </div>
                        </div>

                        <!-- Icons of picked heroes -->
                        <div class="col-lg-4 heroicons">
                            <img height="28" src="images/icons/abaddon.png" />
                            <img height="28" src="images/icons/alchemist.png" />
                            <img height="28" src="images/icons/antimage.png" />
                            <img height="28" src="images/icons/chen.png" />
                            <img height="28" src="images/icons/drow.png" />

                            <img height="28" src="images/icons/enigma.png" />
                            <img height="28" src="images/icons/pudge.png" />
                            <img height="28" src="images/icons/kunkka.png" />
                            <img height="28" src="images/icons/lina.png" />
                            <img height="28" src="images/icons/zuus.png" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabs for opened entities and stuff -->
            <div id="content" class="panel panel-default">
                <div class="panel-body">
                    <div id="tabs">
                        <!-- Nav tabs, see addTab -->
                        <ul class="nav nav-pills"></ul>
                        <hr />
                        <!-- Tab panes, see addTab -->
                        <div class="tab-content"></div>
                    </div>
                </div>
             </div>
        </div>

        <!-- Intro View -->
        <div class="alice-view" id="about-view">
            <div class="col-lg-5">
                <h4>Loading a Replay</h4>
                <p>
                    When you opened the DevKit it asked you to select a folder. This folder should contain the
                    replays you want to parse. To open a replay, first click on the Control button at the top
                    right hand side.
                </p>
                <p>
                    The caret next to the open button shows you a list of replays to choose from. Opening a replay
                    automatically closes the last opened replay and removes all content related to it.
                </p>

                <h4>First Steps</h4>
                <p>
                    A replay is divided into a range of different messages. The first couple messages contain mostly
                    data required to setting up send and receive tables, while later messages only contain entity
                    updates.
                </p>
                <p>
                    You can select the number of messages you want to parse in the control panel. As the parsing
                    happens on the sever-side of the applications, parsing higher number of messages does only
                    increase the loading time by a very small amount.
                </p>
                <p>
                    Once you have reached the first message containing picks and game data, the corresponding
                    fields in the control panel will automatically show you the received data.
                </p>

                <h4>Entities</h4>
                <p>
                    Entities contain everything you see in the game, such as heroes, creeps and the current
                    cursor position. Entities by themselves are not unique and may contain data linking them
                    to other entities, for example Players and their selected heroes.
                </p>
                <p>
                    They also contain the gamestate which includes properties like the score or the number of
                    spectators.
                </p>

                <h4>Stringtables</h4>
                <p>
                    Stringtables contain a wide-range of different data grouped unter different keys.
                </p>
                <p>
                    The DevKit only shows data for a small range of stringtables as we haven't figure out
                    how to parse most of them yet.
                </p>

                <h4>Recvprops</h4>
                <p>
                    Displays a list of flattened sendtables.
                </p>
                <p>
                    A sendtable is a list of property definitions for a given type, such as a hero or a player
                    ressource. These properties need to be filtered and re-arranged in order to reflect the way
                    the server presents them. The flattened sendtable or "Recvprop" is the correct representation
                    of that.
                </p>
                <h4>Sendprops</h4>
                <p>
                    This is the unfiltered list of Sendprops. Only really interesting for debugging and
                    development purposes.
                </p>
            </div>
            <div class="col-lg-1">
                &nbsp;
            </div>
            <div class="col-lg-6 border">
                <h4>About</h4>
                <p>
                    This development kit is part of <a href="https://github.com/AliceStats">Alice</a>.<br />
                    Alice is FOSS software licensed under the
                    <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache 2.0 License</a>.
                </p>
                <h4>3rd-Party Software</h4>
                <p>
                    This website uses the following 3rd-Party software:
                    <ul>
                        <li><a href="http://getbootstrap.com/">Twitter Bootstrap</a></li>
                        <li><a href="http://www.jquery.com/">jQuery</a></li>
                        <li><a href="http://handlebarsjs.com/">Handlebar JS</a></li>
                        <li><a href="http://glyphicons.com/">Glyphicon Halfling Icons</a></li>
                        <li><a href="http://www.dota2.com/">Dota 2 Minimap Icons</a></li>
                    </ul>
                </p>
            </div>
        </div>

        <!-- Entities Modal -->
        <div id="entities-modal">
            <div class="modal fade" id="entityModal" tabindex="-1" role="dialog" aria-labelledby="entityModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="entityModalLabel">Entity List</h4>
                        </div>
                        <div class="modal-body">
                            <h6>Select entities below to load their content.</h6>
                            <select size=20 multiple class="form-control">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Load</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Entities View -->
        <div class="alice-view" id="entities-view">
            <table class="table table-condensed table-condensed">
                <thead>
                    <tr>
                        <th>ID</th><th>Name</th><th>Type</th><th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>0</td>
                        <td>m_vecSomething</td>
                        <td>VectorXY</td>
                        <td>[123|456]</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Stringtables Modal -->
        <div id="stringtables-modal">
            <div class="modal fade" id="stringtableModal" tabindex="-1" role="dialog" aria-labelledby="stringtableModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="stringtableModalLabel">Stringtable List</h4>
                        </div>
                        <div class="modal-body">
                            <h6>Select a stringtable from below to load its content.</h6>
                            <select size=20 class="form-control">
                                <optgroup label="baselineinstance">
                                    <option>123</option>
                                    <option>456</option>
                                    <option>789</option>
                                </optgroup>
                                <optgroup label="baselineinstance2">
                                    <option>123</option>
                                    <option>456</option>
                                    <option>789</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Load</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stringtables View -->
        <div class="alice-view" id="stringtables-view">
            <!-- Subjective to each template, need to implement -->
        </div>

        <!-- Recvprops View -->
        <div class="alice-view" id="recvprops-view">
            <div class="panel-group" id="accordion">

                <div class="panel panel-default">
                    <!-- header -->
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#propertyone">
                                Property #1
                            </a>
                        </h4>
                    </div>

                    <!-- content -->
                    <div id="propertyone">
                        <div class="panel-body">
                            <div class="col-lg-4">
                                Recvprop details
                            </div>
                            <div class="col-lg-8">
                                Recvprop properties table
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Sendprops View -->
        <div class="alice-view" id="sendprops-view">

        </div>

        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="//code.jquery.com/jquery.js"></script>
        <!-- Bootstrap Javascript -->
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
        <!-- Handlebar Javasacript -->
        <script src="js/handlebars-v1.3.0.js"></script>
        <!-- Growl-like notifications -->
        <script src="js/jquery.bootstrap-growl.min.js"></script>
        <!-- Our own Javascript -->
        <script type="text/javascript">
            var composeCount = 0;   // number of tabs added to switch to the last created one

            // shows a specific tab
            function switchToTab(tabId) {
                $('#tabs a[href="#' + tabId + '"]').tab('show');
            }

            // adds a new tab containing the specified html
            function addTab(title, content) {
                $("#content").show();
                var tabId = "tab" + composeCount++;
                $('#tabs .nav-pills').append('<li><a href="#' + tabId + '"><button class="close closeTab" type="button" >&times;</button> '+title+' </a></li>');
                $('#tabs .tab-content').append('<div class="tab-pane" id="' + tabId + '">'+content+'</div>');
                switchToTab(tabId);
            }

            // does an api request
            function request(type, args, callback) {
                $.ajax({
                    url: "/api/"+type+"/"+args
                }).done(function(data) {
                    if (data.success) {
                        callback(data);
                    } else {
                        $.bootstrapGrowl(data.data, {
                            type: 'error',
                            align: 'center',
                            width: 'auto',
                            allow_dismiss: false
                        });
                    }
                });
            }

            // initialize page
            $(function () {
                // register onClose for all tabs
                $("#tabs").on("click", ".close", function () {
                    var tabContentId = $(this).parent().attr("href");
                    $(this).parent().parent().remove(); //remove li of tab
                    $(tabContentId).remove(); //remove respective tab content

                    if ($("#tabs .tab-content").html() === "") {
                        $("#content").hide();
                    }
                });

                // register onClick for all tabs
                $("#tabs").on("click", "a", function (e) {
                    e.preventDefault();
                    $(this).tab('show');
                });

                // toggle control board
                $("#toggle-control").click(function() {
                    $("#control").toggle();
                });

                // add about tab
                $("#main-about").click(function() {
                    addTab("About", $("#about-view").html());
                });

                // hide the control panel by default
                $("#control").toggle();

                // add the about tab
                addTab("About", $("#about-view").html());
            });
        </script>
    </body>
</html>